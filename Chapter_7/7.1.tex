\documentclass[../main.tex]{subfiles}
\begin{document}

本章讨论的离散时间 Markov 链是一种特殊的随机过程，其指标集 $T$ 和状态空间 $S$ 都是离散的，不妨记为 $T=\{0,1,\cdots\},S=\{0,1,\cdots\}$。

\begin{definition}\label{def:7.1.1}
    若随机过程 $\{X_n,n=0,1,\cdots\}$ 的状态空间为 $S$，满足 $\forall n\in\mathbb N,\forall i,j,i_0,\cdots,i_{n-1}\in S,P(X_{n+1}=j|X_0=i_0,\cdots,X_{n-1}=i_{n-1},X_n=i)=P(X_{n+1}=j|X_n=i)$，则称 $\{X_n,n=0,1,\cdots\}$ 为\emph{（离散时间）Markov 链}，上式称为 \emph{Markov 性}，又称\emph{无后效性}。
\end{definition}

可以直接利用 Markov 性给出 $(X_0,\cdots,X_n)$ 的联合分布，即
\begin{equation*}
    \begin{aligned}
          & P(X_0=i_0,\cdots,X_n=i_n)                                                                       \\
        = & P(X_n=i_n|X_0=i_0,\cdots,X_{n-1}=i_{n-1})P(X_0=i_0,\cdots,X_{n-1}=i_{n-1})                      \\
        = & P(X_n=i_n|X_{n-1}=i_{n-1})P(X_0=i_0,\cdots,X_{n-1}=i_{n-1})                                     \\
        = & \cdots                                                                                          \\
        = & P(X_n=i_n|X_{n-1}=i_{n-1})P(X_{n-1}=i_{n-1}|X_{n-2}=i_{n-2})\cdots P(X_1=i_1|X_0=i_0)P(X_0=i_0)
    \end{aligned}
\end{equation*}

\begin{definition}\label{def:7.1.2}
    若 $\{X_n,n=0,1,\cdots\}$ 为离散时间 Markov 链，称 $P(X_{n+1}=j|X_n=i)$ 为其\emph{（一步）转移概率}，若其与 $n$ 无关，则称该 Markov 链关于时间是\emph{齐次}的，此时记 $p_{ij}=P(X_{n+1}=j|X_n=i)$，称 $P=(p_{ij})$ 为\emph{转移概率矩阵}。
\end{definition}

显然有 $\forall i,j,p_{ij}\geq0,\sum_{j\in S}p_{ij}=1$。

状态空间有限时称该 Markov 链为\emph{有限链}，否则称为\emph{无限链}。多数情况下只讨论关于时间齐次的有限 Markov 链。

利用转移概率，容易写出 $P(X_0=i_0,\cdots,X_n=i_n)=P(X_0=i_0)p_{i_0i_1}\cdots p_{i_{n-1}i_n}$。

\begin{example}
    假设每天的天气只与前一天的天气有关：
    \begin{itemize}
        \item 若前一天是雨天，则第二天是雨天的概率为 $1/3$，晴天的概率为 $2/3$
        \item 若前一天是晴天，则第二天是雨天的概率为 $1/2$，晴天的概率为 $1/2$
    \end{itemize}
    则各天的天气构成一个 Markov 链，其状态空间 $S=\{r,s\}$，其中 $r$ 和 $s$ 分别表示雨天和晴天。其转移概率矩阵为
    \[
        \begin{blockarray}{ccc}
            & r & s \\
            \begin{block}{c(cc)}
                r & \frac13 & \frac23 \\
                s & \frac12 & \frac12 \\
            \end{block}
        \end{blockarray}
    \]
    该 Markov 链的\emph{转移概率图}如下。
    \begin{center}
        \begin{tikzpicture}[->, >=stealth', auto, semithick, node distance=3cm]
            \tikzstyle{state}=[fill=white,draw=black,circle,thick]
            \node[state] (r) {$r$};
            \node[state] (s) [right of=r] {$s$};
            \path (r) edge[bend left] node[above] {$2/3$} (s);
            \path (s) edge[bend left] node[below] {$1/2$} (r);
            \path (r) edge[loop left] node[left] {$1/3$} (r);
            \path (s) edge[loop right] node[right] {$1/2$} (s);
        \end{tikzpicture}
    \end{center}
\end{example}

\begin{example}
    设 $\{X_i\}_{i=1}^\infty$ 独立同分布，且 $P(X_i=1)=1-P(X_i=-1)=p$，令 $X_0=0,Y_n=\sum_{i=0}^nX_i$，则 $\{Y_n,n\in\mathbb N\}$ 是一维随机游走，状态空间 $S=\mathbb Z$，且其为 Markov 链，转移概率为 $p_{i,i+1}=p,p_{i,i-1}=1-p$。
\end{example}

\begin{example}
    状态空间为 $S=\{0,\cdots,N\}$ 的 Markov 链，对于 $i=1,\cdots,N-1$ 其转移概率同上例，而 $p_{00}=1,p_{01}=0,p_{NN}=1,p_{N,N-1}=0$，则称为具有\emph{吸收壁}的随机游走，$0$ 和 $N$ 称为\emph{吸收态}。其转移概率矩阵为
    \[
        \begin{blockarray}{ccccccccc}
            & 0 & 1 & 2 & 3 & \cdots & N-2 & N-1 & N \\
            \begin{block}{c(cccccccc)}
                0      & 1 & 0 & 0 & 0 & \cdots & 0 & 0 & 0 \\
                1      & 1-p & 0 & p & 0 & \cdots & 0 & 0 & 0 \\
                2      & 0 & 1-p & 0 & p & \cdots & 0 & 0 & 0 \\
                \vdots & \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
                N-1    & 0 & 0 & 0 & 0 & \cdots & 1-p & 0 & p \\
                N      & 0 & 0 & 0 & 0 & \cdots & 0 & 0 & 1 \\
            \end{block}
        \end{blockarray}
    \]
\end{example}

\begin{example}
    现假设每天的天气只与前两天的天气有关：
    \begin{itemize}
        \item 若前两天是雨天，则第三天是雨天的概率为 $0.7$，晴天的概率为 $0.3$
        \item 若前两天分别是晴天和雨天，则第三天是雨天的概率为 $0.5$，晴天的概率为 $0.5$
        \item 若前两天分别是雨天和晴天，则第三天是雨天的概率为 $0.4$，晴天的概率为 $0.6$
        \item 若前两天是晴天，则第三天是雨天的概率为 $0.2$，晴天的概率为 $0.8$
    \end{itemize}
    则仍可构造 Markov 链，其状态空间 $S=\{rr,sr,rs,ss\}$，各状态表示近两天的天气，则转移概率矩阵为
    \[
        \begin{blockarray}{ccccc}
            & rr & sr & rs & ss\\
            \begin{block}{c(cccc)}
                rr & 0.7 & 0 & 0.3 & 0\\
                sr & 0.5 & 0 & 0.5 & 0\\
                rs & 0 & 0.4 & 0 & 0.6\\
                ss & 0 & 0.2 & 0 & 0.8\\
            \end{block}
        \end{blockarray}
    \]
\end{example}

\end{document}
